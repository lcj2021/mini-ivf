
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Remote Call Framework (RCF) - Delta V Software</title>
    <!-- Bootstrap core CSS -->
    <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom styles for this template -->
    <!-- JL: Using timestamp here to prevent css file from being cached -->
    <link href="../css/website.css?<?php echo time(); ?>" rel="stylesheet" />
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
    <link href="doxygenBase.css" rel="stylesheet" type="text/css" />
    <link href="doxyStylesheet.css" rel="stylesheet" type="text/css"/>
<link href="doxySidebarFixes.css" rel="stylesheet" type="text/css"/>
    <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet" />
    <script type="text/javascript" src="doxy-boot.js"></script>
</head>
<body style="padding-top: 0px">
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light navbar-fixed-top" style="top: 20px;">
        <!-- <nav class="navbar navbar-expand-lg fixed-top"> -->
        <div class="container">
            <a class="navbar-brand" href="index.html"><img src="RCF_Logo_70px.png" height="70" /> </img></a>
            <!--
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item" style="padding-top: 0px;">
                        <a class="nav-link" href="../index.html"><i class="fa fa-home"></i></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Documentation</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../download.html">Download</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../licensing.html">Licensing</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../about.html">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../contact.html">Contact</a>
                    </li>
                </ul>
            </div>
                -->
        </div>
    </nav>
        <div class="container">
        <div class="row">
            <div class="col-lg-12">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Remote Call Framework 3.4
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_proxy_endpoints.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Proxy Endpoints </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#ProxyServer">Configuring a Proxy Server</a></li>
<li class="level1"><a href="#DestinationServer">Configuring a Destination Server</a></li>
<li class="level1"><a href="#ClientProxy">Connecting Through a Proxy Server</a></li>
<li class="level1"><a href="#TwoWayCommunication">Two-way communication using proxy endpoints</a></li>
</ul>
</div>
<div class="textblock"><p>Proxy endpoints allow RCF clients to connect to RCF servers that they are otherwise unable to connect directly to.</p>
<p>There are a number of situations in which a client may be unable to establish a direct network connection to a server it intends to call.</p>
<ul>
<li>The network address of the server may not be known to the client.</li>
<li>The network address of the server may be dynamic.</li>
<li>There may be firewalls or other network infrastructure present, preventing direct client-to-server network connections.</li>
</ul>
<p>Proxy endpoints provide a workaround for these situations, allowing one RCF server (the proxy server) to serve as a proxy for another RCF server (the destination server). The proxy server maintains a pool of connections from the destination server, and uses these connections to allow clients to connect through to the destination server.</p>
<h1><a class="anchor" id="ProxyServer"></a>
Configuring a Proxy Server</h1>
<p>The proxy server accepts connections from a destination server, and keeps these connections in a connection pool. The connections are then subsequently used for clients wanting to connect to that particular destination server.</p>
<p>Each destination server must present a name to the proxy server. The destination server name is arbitrary and chosen by your application. The clients will use the destination server name to specify which server they want to connect to.</p>
<p>To set up a proxy server, you configure a <code><a class="el" href="class_r_c_f_1_1_rcf_server.html" title="Provides RCF server-side functionality. ">RCF::RcfServer</a></code> as usual, and then call <code><a class="el" href="class_r_c_f_1_1_rcf_server.html#a54730b50ed5e932c4ca237f59981d287" title="Sets whether proxy endpoints are enabled on this RcfServer. ">RCF::RcfServer::setEnableProxyEndpoints()</a></code>. Once started, the <code>RcfServer</code> will begin registering destination servers and proxying connections from clients to those destination servers.</p>
<div class="fragment"><div class="line">    <span class="comment">// Proxy server.</span></div><div class="line">    <span class="keywordtype">int</span> proxyPort = 50001;</div><div class="line">    <a class="code" href="class_r_c_f_1_1_rcf_server.html">RCF::RcfServer</a> proxyServer( <a class="code" href="class_r_c_f_1_1_tcp_endpoint.html">RCF::TcpEndpoint</a>(<span class="stringliteral">&quot;0.0.0.0&quot;</span>, proxyPort) );</div><div class="line">    proxyServer.setEnableProxyEndpoints(<span class="keyword">true</span>);</div><div class="line">    proxyServer.setThreadPool(RCF::ThreadPoolPtr(<span class="keyword">new</span> <a class="code" href="class_r_c_f_1_1_thread_pool.html">RCF::ThreadPool</a>(1,10)));</div><div class="line">    proxyServer.start();</div></div><!-- fragment --><p> At any time, you can query the proxy server, for the names of the proxy endpoints that are currently available:</p>
<div class="fragment"><div class="line">    std::vector&lt;std::string&gt; proxyEndpointNames;</div><div class="line">    proxyServer.enumerateProxyEndpoints(proxyEndpointNames);</div></div><!-- fragment --><h1><a class="anchor" id="DestinationServer"></a>
Configuring a Destination Server</h1>
<p>The destination <code>RcfServer</code> is configured with a <code><a class="el" href="class_r_c_f_1_1_proxy_endpoint.html" title="Represents a proxy endpoint. ">RCF::ProxyEndpoint</a></code> parameter, specifying the network address of the proxy server, and the name the destination server will be exposed as.</p>
<div class="fragment"><div class="line">    <span class="comment">// Destination server.</span></div><div class="line">    <a class="code" href="class_r_c_f_1_1_rcf_server.html">RCF::RcfServer</a> destinationServer( <a class="code" href="class_r_c_f_1_1_proxy_endpoint.html">RCF::ProxyEndpoint</a>(<a class="code" href="class_r_c_f_1_1_tcp_endpoint.html">RCF::TcpEndpoint</a>(proxyIp, proxyPort), <span class="stringliteral">&quot;RoamingPrintSvr&quot;</span>) );</div><div class="line"></div><div class="line">    PrintService printService;</div><div class="line">    destinationServer.bind&lt;I_PrintService&gt;(printService);</div><div class="line"></div><div class="line">    destinationServer.start();</div></div><!-- fragment --><p> Once started, the destination <code>RcfServer</code> will begin initiating network connections to the proxy server. These connections will subsequently be used by clients to make remote calls back to the destination server.</p>
<h1><a class="anchor" id="ClientProxy"></a>
Connecting Through a Proxy Server</h1>
<p>Once the destination server and proxy server are up and running, a client can connect to the destination server by using a <code><a class="el" href="class_r_c_f_1_1_proxy_endpoint.html" title="Represents a proxy endpoint. ">RCF::ProxyEndpoint</a></code> and specifying the proxy server along with the name of the destination server.</p>
<div class="fragment"><div class="line">    <span class="comment">// Client calling through to destination server, using in-process access to the proxy server.</span></div><div class="line">    RcfClient&lt;I_PrintService&gt; client( <a class="code" href="class_r_c_f_1_1_proxy_endpoint.html">RCF::ProxyEndpoint</a>(proxyServer, <span class="stringliteral">&quot;RoamingPrintSvr&quot;</span>) );</div><div class="line">    client.Print(<span class="stringliteral">&quot;Calling I_PrintService through a proxy endpoint.&quot;</span>);</div></div><!-- fragment --> <div class="fragment"><div class="line">    <span class="comment">// Client calling through to destination server, using network access to the proxy server.</span></div><div class="line">    RcfClient&lt;I_PrintService&gt; client(<a class="code" href="class_r_c_f_1_1_proxy_endpoint.html">RCF::ProxyEndpoint</a>(<a class="code" href="class_r_c_f_1_1_tcp_endpoint.html">RCF::TcpEndpoint</a>(proxyIp, proxyPort), <span class="stringliteral">&quot;RoamingPrintSvr&quot;</span>));</div><div class="line">    client.Print(<span class="stringliteral">&quot;Calling I_PrintService through a proxy endpoint.&quot;</span>);</div></div><!-- fragment --><p> Using a proxied connection, the client can make remote calls as usual, and is able to disconnect and re-connect, just as with an un-proxied connection. Distinct RCF clients will have distinct network connections to the destination server, and the lifetime of any session objects created on the destination server, will be mapped to the lifetime of the clients proxied network connection.</p>
<h1><a class="anchor" id="TwoWayCommunication"></a>
Two-way communication using proxy endpoints</h1>
<p>It's quite common to have a situation where clients connect to a server, but subsequently the server needs to be able to make remote calls in the opposite direction, back to the clients. We refer to this as two-way communication.</p>
<p>Beginning with RCF 3.0, two-way communication is supported using proxy endpoints. For example, assume we have a server process and a client process, and we want to implement two-way communication between them. In the server process, you would enable proxy endpoint support on the <code>RcfServer</code>:</p>
<div class="fragment"><div class="line">        <span class="comment">// Server process listening on port 50001, with proxy endpoint support enabled.</span></div><div class="line">        <a class="code" href="class_r_c_f_1_1_rcf_server.html">RCF::RcfServer</a> proxyServer(<a class="code" href="class_r_c_f_1_1_tcp_endpoint.html">RCF::TcpEndpoint</a>(<span class="stringliteral">&quot;0.0.0.0&quot;</span>, 50001));</div><div class="line">        proxyServer.setEnableProxyEndpoints(<span class="keyword">true</span>);</div></div><!-- fragment --><p> Any server-side code that needs to make a call to the client process, would do so by using a proxy endpoint:</p>
<div class="fragment"><div class="line">        <span class="comment">// Server-side code, making calls to the client process.</span></div><div class="line">        RcfClient&lt;I_PrintService&gt; client(<a class="code" href="class_r_c_f_1_1_proxy_endpoint.html">RCF::ProxyEndpoint</a>(proxyServer, <span class="stringliteral">&quot;SomeUniqueClientId&quot;</span>));</div><div class="line">        client.Print(<span class="stringliteral">&quot;Making call from server to client.&quot;</span>);</div></div><!-- fragment --><p> In the client process, you need to start a <code>RcfServer</code>, configured with the relevant proxy endpoint, in order to receive calls from the server process:</p>
<div class="fragment"><div class="line">        <span class="comment">// Client-side configuration code, to allow calls to be received from the server process.</span></div><div class="line">        PrintService printService;</div><div class="line">        std::string serverAddress;</div><div class="line">        <a class="code" href="class_r_c_f_1_1_tcp_endpoint.html">RCF::TcpEndpoint</a> serverEp(serverAddress, 50001);</div><div class="line">        <a class="code" href="class_r_c_f_1_1_rcf_server.html">RCF::RcfServer</a> server(<a class="code" href="class_r_c_f_1_1_proxy_endpoint.html">RCF::ProxyEndpoint</a>(serverEp, <span class="stringliteral">&quot;SomeUniqueClientId&quot;</span>) );</div><div class="line">        server.<a class="code" href="class_r_c_f_1_1_rcf_server.html#a3e8f6a060a87beb96b5690e9829c9c3f">bind</a>&lt;I_PrintService&gt;(printService);</div><div class="line">        server.<a class="code" href="class_r_c_f_1_1_rcf_server.html#a737d7cf9860b1d49209b2ebe891e4449">start</a>();</div></div><!-- fragment --></div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <!--  -->
    <li class="footer">Copyright (C) <a href="http://www.deltavsoft.com">Delta V Software</a> 2023</li>
    <!-- <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li> -->
  </ul>
</div>
                            </div>
        </div>
    </div>
</body>
</html>
